     1                                  ; hello-os
     2                                  ; TAB=4
     3                                  
     4                                    ORG 0x7c00  ;指明程序的装载地址
     5                                  
     6                                  ; 以下的记述用于标准FAT12格式的软盘
     7                                  
     8 00000000 EB4E                      JMP entry
     9 00000002 90                        db  0x90
    10 00000003 48415249424F5445          db  "HARIBOTE"
    11 0000000B 0002                      dw  512
    12 0000000D 01                        db  1
    13 0000000E 0100                      dw  1
    14 00000010 02                        db  2
    15 00000011 E000                      dw  224
    16 00000013 400B                      dw  2880
    17 00000015 F0                        db  0xf0
    18 00000016 0900                      dw  9
    19 00000018 1200                      dw  18 
    20 0000001A 0200                      dw  2
    21 0000001C 00000000                  dd  0
    22 00000020 400B0000                  dd  2880
    23 00000024 000029                    db  0,0,0x29
    24 00000027 FFFFFFFF                  dd  0xffffffff
    25 0000002B 48415249424F54454F-       db  "HARIBOTEOS "
    25 00000034 5320               
    26 00000036 4641543332202020          db  "FAT32   "
    27 0000003E <res 00000012>            resb  18
    27          ******************       warning: uninitialized space declared in .text section: zeroing
    28                                  
    29                                  ;程序核心
    30                                  entry:      ;0x7c50
    31 00000050 B80000                    mov AX,0  ; 初始化寄存器
    32 00000053 8ED0                      mov SS,AX
    33 00000055 BC007C                    mov SP,0x7c00
    34 00000058 8ED8                      mov DS,AX
    35 0000005A 8EC0                      mov ES,AX
    36                                  
    37                                  ; 读盘时的参数
    38 0000005C B82008                  	mov	AX,0x0820
    39 0000005F 8EC0                    	mov	ES,AX
    40 00000061 B500                    	mov	CH,0				;	柱面 0
    41 00000063 B600                    	mov	DH,0				;	磁头 0
    42 00000065 B102                    	mov	CL,2				;	扇区 2
    43                                  	
    44                                  ; 读盘指令
    45 00000067 B402                    	mov	AH,0x02			; 读盘指令
    46 00000069 B001                    	mov	AL,1				;	1个扇区
    47 0000006B BB0000                  	mov	BX,0
    48 0000006E B200                    	mov	DL,0x00			;	A驱动器
    49 00000070 CD13                    	INT	0x13				; 调用磁盘BIOS
    50 00000072 7200                    	JC	error
    51                                  
    52                                  error:
    53 00000074 BE[8B00]                  mov SI,msg
    54                                  
    55                                  putloop:
    56 00000077 8A04                      mov AL,[SI]
    57 00000079 83C601                    add SI,1
    58 0000007C 3C00                      cmp AL,0
    59                                  
    60 0000007E 7408                      je  fin
    61 00000080 B40E                      mov AH,0x0e ;显示一个文字
    62 00000082 B300                      mov BL,0   ;指定字符颜色
    63 00000084 CD10                      INT 0x10    ;调用显卡BIOS
    64 00000086 EBEF                      jmp putloop
    65                                  
    66                                  fin:
    67 00000088 F4                        HLT         ;让CPU停止，等待指令
    68 00000089 EBFD                      jmp fin
    69                                  
    70                                  msg:              ;0x7c74
    71 0000008B 0A0A                      DB  0x0a, 0x0a  ;换行两次
    72 0000008D 48454C4C4F2C20776F-       db  "HELLO, world"
    72 00000096 726C64             
    73 00000099 0A                        db  0x0a        ;换行
    74 0000009A 00                        db  0
    75                                  
    76 0000009B 00<rept>                  times 510-($-$$) db 0
    77 000001FE 55AA                      db  0x55,0xaa
